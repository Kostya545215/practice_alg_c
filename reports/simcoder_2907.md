## Simcode

Simcode - отдельный инструмент, позволяющий генерировать С-код из электрических схем, построенных в PSIM (если гуглить программу, то как я понимаю это Altair PSIM).

Генерация кода заточена под архитектуру TI C2000 DSP

PSIM заточен под силовую электронику и управление. У PSIM ограниченные возможности по аналоговой электронике общего назначения. 

---

Simulink не подходит для задачи моделирования реальной системы на микроконтроллере 

Есть другие библиотеки кроме simscape - simscape electrical, specialized power systems, но они все не поддерживают генерацию кода на микроконтроллер, все simulation only/continuos solver

---
Есть специальное приложение для задач моделирования силовой электрической системы на микроконтроллере - Typhoon HIL (аналог Simulink + Simscape, но для HIL). Но необходимо покупать специальное оборудование HIL, на которое будет загружаться ПО (HIL402, HIL604), которое невероятно дорогостоящее.

---
Simulink Desktop Real-Time позволяет:
- Синхронизировать исполнение с реальными тактами системы (до 20 кГц, а надо 8)
    
- Обеспечивать настоящую real-time работу модели, как будто она работает в железе

Т.е модель не будет работать на реальном железе при таком подходе, будет симуляция на ПК, но модель будет приближенна, ведь будет работать в real-time. Это называется External-HIL. 

Ставится фиксированный шаг модели (например, 125 мкс). SDRT компилирует модель в исполняемый real-time процесс. Он исполняется с жёсткой частотой и временем исполнения. Если модель не успевает за отведённое время — real-time нарушается  это называется **overrun** (перегрузка). Это можно будет отслеживать. 
Можно подавать сигналы с реальных устройств на комп 

Но даже на обычном ПК встает проблема с Real-time. Если установить sample time решателя недостаточно малым, то он будет решать достаточно криво - модель будет неточной. Если установить слишком малым, то мы не сможем работать в real-time, так не хватит мощности процессора ПК, чтобы пересчитывать модель каждую микросекунду.

--- 
Simcoder в PSIM позволяет создать модель инвертора и загрузить его на микроконтроллер. Официально нет поддержки для Stm32 - не будет ScopeView(не будет отладки), нет автогенерации PWM/ADC, нет HAL, только ANSI C-код(без автозагрузки), нужна ручная вставка I/O функций. 

---

PSIM + SimCoder поддерживает полную автоматическую генерацию кода управления трёхфазным инвертором и загрузку на TI C2000, он сможет работать на 8кГц. 

[Tutorial auto code generation for F2806X target](https://2023.help.altair.com/psim-tut/tutorials/Tutorial%20-%20Auto%20Code%20Generation%20for%20F2806x%20Target.pdf?utm_source=chatgpt.com)

---

Итог - simulink + какие-либо внутренние библиотеки с электроникой не подойдут для загрузки модели инвертора на stm32. PSIM позволит создать модель инвертора и загрузить ее на микроконтроллер, мощности должно хватать. Есть проблема с тем, что будет множество трудностей, если работать в PSIM с МК stm32, ведь нет его официальной поддержки, поэтому стоит перейти на микроконтроллеры TI.